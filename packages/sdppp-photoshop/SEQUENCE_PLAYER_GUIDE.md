# 序列帧播放器功能使用指南

## 功能概述

新增的序列帧播放器允许你从图像预览中选择多张图片，组成一个序列帧列表，然后可以按照设定的时间间隔自动播放，类似于GIF动画或视频预览。

## 🎯 核心功能

### 1. 添加图片到序列帧

有两种方式将图片添加到序列帧列表：

#### 方式一：单图模式
1. 在图像预览区（上方）浏览到要添加的图片
2. 将鼠标悬停在左下角的图片计数器上（显示 `1 / 5` 这样的数字）
3. 点击展开的菜单中的 **"添加到序列帧"** 选项
4. 当前显示的图片会被添加到下方的序列帧列表

#### 方式二：多图模式
1. 点击右上角的图标切换到多图视图模式
2. 点选你想要添加的图片（可以选择多张）
3. 将鼠标悬停在左下角的选中计数器上（显示 `3 / 10` 这样的数字）
4. 点击展开的菜单中的 **"添加选中到序列帧"** 选项
5. 所有选中的图片会被批量添加到序列帧列表

### 2. 播放控制

序列帧播放器位于图像预览区下方，提供以下控制：

#### 播放控制按钮
- **⬅️ 上一帧**: 手动切换到前一张图片
- **▶️ 播放 / ⏸️ 暂停**: 开始或暂停自动播放
- **➡️ 下一帧**: 手动切换到下一张图片

#### 帧信息显示
- 中间显示当前帧数和总帧数（如 `3 / 10`）

### 3. 调整播放速度

在播放器右侧有一个输入框：
- **标签**: "间隔(毫秒)"
- **范围**: 100ms - 10000ms（0.1秒 - 10秒）
- **步进**: 100ms
- **默认值**: 1000ms（1秒）

**示例速度设置**:
- 快速播放: 200ms (5帧/秒)
- 正常播放: 1000ms (1帧/秒) - 默认
- 慢速播放: 2000ms (0.5帧/秒)
- 超慢播放: 5000ms (0.2帧/秒)

### 4. 管理序列帧

#### 预览大图
- 序列帧播放器上方显示当前帧的大图预览
- 点击下方缩略图可以跳转到对应的帧

#### 缩略图列表
- 下方横向滚动的缩略图列表显示所有序列帧
- 当前播放的帧会有蓝色边框高亮显示
- 每个缩略图左上角显示帧序号（1, 2, 3...）
- 鼠标悬停在缩略图上会显示删除按钮（红色 ❌）

#### 删除单个帧
1. 将鼠标悬停在要删除的缩略图上
2. 点击右上角出现的红色删除按钮
3. 该帧会从序列中移除

#### 清空所有帧
- 点击播放器右上角的 **"清空"** 按钮（带清空图标 🗑️）
- 所有序列帧会被清空

## 📱 用户界面

```
┌─────────────────────────────────────────────┐
│         图像预览区（上方）                    │
│  [模式切换] [+]                [1/10] [删除] │
│                                   [发送按钮]  │
└─────────────────────────────────────────────┘
────────────────────────────────────────────────
┌─────────────────────────────────────────────┐
│         序列帧播放器（下方）                  │
│  ┌───────────────────────────────────────┐  │
│  │                                       │  │
│  │        当前帧大图预览区                │  │
│  │                                       │  │
│  └───────────────────────────────────────┘  │
│                                             │
│  [⬅️] [▶️] [➡️]  3/10    间隔(毫秒): [1000] [🗑️] │
│                                             │
│  ┌─┐ ┌─┐ ┌─┐ ┌─┐ ┌─┐                      │
│  │1│ │2│ │3│ │4│ │5│ ...                   │
│  └─┘ └─┘ └─┘ └─┘ └─┘                      │
└─────────────────────────────────────────────┘
```

## 💡 使用场景

### 场景1: 查看AI生成的连续变化
1. 使用AI工具生成一系列渐变的图片
2. 将它们依次添加到序列帧
3. 播放序列帧查看过渡效果

### 场景2: 预览动画序列
1. 从PS的多个图层导入图片
2. 按顺序添加到序列帧
3. 调整播放速度预览动画效果

### 场景3: 对比不同版本
1. 添加同一张图片的不同处理版本
2. 使用较慢的播放速度（如2-3秒）
3. 仔细对比每一帧的差异

## ⚙️ 技术细节

### 文件结构
- `SequencePlayer.tsx` - 序列帧播放器组件
- `SequencePlayer.less` - 样式文件
- `App.store.ts` - 状态管理（sequenceFrames）
- `ImagePreviewWrapper.tsx` - 集成序列帧播放器

### 状态管理
序列帧数据存储在 Zustand store 中：
```typescript
sequenceFrames: Array<{
  url: string,
  thumbnail_url: string,
  nativePath?: string,
}>
```

### 主要方法
- `addToSequenceFrames(images)` - 添加图片到序列
- `removeSequenceFrame(index)` - 删除指定帧
- `clearSequenceFrames()` - 清空所有帧

## 🎨 样式特点

### 视觉反馈
- **当前帧高亮**: 蓝色边框 + 阴影效果
- **缩略图悬停**: 边框变蓝 + 轻微放大
- **删除按钮**: 鼠标悬停时淡入显示

### 响应式设计
- 播放控制按钮可以自适应换行
- 缩略图列表支持横向滚动
- 自定义滚动条样式

## 🔧 故障排查

### 问题: 图片不显示
**解决方案**: 
- 检查图片URL是否有效
- 查看浏览器控制台是否有错误
- 尝试重新添加图片

### 问题: 播放卡顿
**解决方案**:
- 增加播放间隔（如从500ms改为1000ms）
- 减少序列帧数量
- 检查图片大小是否过大

### 问题: 无法删除帧
**解决方案**:
- 确保鼠标正确悬停在缩略图上
- 检查是否有JavaScript错误
- 刷新页面重试

## 📝 注意事项

1. **性能**: 建议序列帧数量不超过50张，以保证流畅播放
2. **内存**: 大量高分辨率图片可能占用较多内存
3. **持久化**: 序列帧数据不会持久化保存，刷新页面后会清空
4. **播放循环**: 播放到最后一帧后会自动从第一帧开始循环

## 🚀 快速开始

**最简单的使用流程**:
1. 从PS导入几张图片到预览区
2. 切换到多图模式，全选图片
3. 点击"添加选中到序列帧"
4. 点击播放按钮 ▶️
5. 调整播放速度查看效果

就这么简单！享受序列帧播放功能吧！ 🎉

